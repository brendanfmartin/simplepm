<!doctype html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="public/main.css">
		<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>	
	</head>
	<body>
		<div class="container task_list">
			<h1><input class="project_name_input" type="text" placeholder="Enter project name..."></h1>
			<span class="project_description"><p>Squid roof party meh, disrupt Portland drinking vinegar Helvetica chambray selvage lo-fi. Readymade Marfa Echo Park Blue Bottle, yr meh hoodie cliche forage 90's organic fashion axe. Umami Intelligentsia pickled slow-carb.</p></span>
			<div class="tasks_header">
				
				<!-- <div class="add_task"></div><br> -->
				<form name="new_task" id="new_task">
					<input type="text" name="task_name" placeholder="Enter tasks..."/><input type="submit" value="submit"/>
				</form>
			</div>
			
		</div>
		
	
		<script src="/socket.io/socket.io.js"></script>
		<script>
		
		$(function(){

			// set method for storing JSON object in localStorage
			Storage.prototype.setObject = function(key, value) {
			    this.setItem(key, JSON.stringify(value));
			}

			// get method for retrieving JSON object in localStorage
			Storage.prototype.getObject = function(key) {
			    var value = this.getItem(key);
			    return value && JSON.parse(value);
			}

			// creating sample JSON for test project
			var Project = {
				"project": {
					"title":"",
					"description":"This projects goal is to create valid JSON and parse it for a standard format",
					"tasks":{
						
					}
				}
			}

			// saving sample project
			localStorage.setObject('project', JSON.stringify(Project));
			var projectObject = localStorage.getObject('project');
			if(Project.project.title){
				$('.project_name').html('<h1>'+Project.project.title+'</h1>');
				$('.project_name_input').css('display', 'none');
			}

			
			$('.project_description').html('<p>'+Project.project.description+'</p>');


			
			$('.add_task').click(function(){
				$('#new_task').toggle();
			});

			$('.task_list').on('mouseup', '.task', function(e){
				// console.log(this);
			})


			var socket = io(), $task_list = $('.task_list');

			// $('.task').click(function(e){
				
			// 	var data = {
			// 		task_name: this.name,
			// 		task_value: this.value,
			// 		task_completed: $(this).is(':checked'),
			// 		task_class: this.className
			// 	}
			// 	socket.emit('task_checked', data);
			// });

			// $('.task_delete').click(function(e){
				
			// });

			// socket.on('task_checked',function(data){
			// 	console.log(data.task_class);
			// 	var task = $('.'+data.task_class+'');
			// 	task.prop('checked', data.task_completed);
			// });

			// socket.on('task_deleted',function(data){
			// 	console.log('task_deleted');
			// });

			socket.on('new_task',function(data){
				$task_list.append('<div class="task">' +
					'<span value="'+data.task_value+'" class="'+data.task_class+' task_title" id="'+data.task_name+'" />'
					+ data.task_name
					+'<span class="task_delete">x</span>'
					+'</div>');
				
				localStorage.setObject('tasks', JSON.stringify(data));
				
			});

			$('#new_task').submit(function(e){
				e.preventDefault();
				var values = {};
				$.each($('#new_task').serializeArray(), function(i, field) {
				    values[field.name] = field.value;
				});
				if(values['task_name'].length > 0) {
					socket.emit('new_task', values);
				}
				$('#new_task').trigger('reset');
			})

			
			
		

			

		});

		</script>
	</body>
</html>